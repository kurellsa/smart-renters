<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; color: #333; line-height: 1.6; }
        .container { width: 100%; max-width: 650px; margin: 0 auto; }
        .report-header { color: #2d3748; border-bottom: 2px solid #edf2f7; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background-color: #f8f9fa; text-align: left; padding: 10px; border-bottom: 2px solid #dee2e6; }
        td { padding: 10px; border-bottom: 1px solid #eee; }
        .status-matched { color: #22c55e; font-weight: bold; }
        .status-discrepancy { color: #ef4444; font-weight: bold; }
        .misc-section { margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px; }
        .btn { background-color: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="report-header">Reconciliation Report: {{ display_month }}</h2>
        <p>The monthly financial audit has been completed. Below is the summary of all components:</p>

        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Collected/Paid</th>
                    <th>Expected</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for comp in components %}
                <tr>
                    <td>{{ comp.name }}</td>
                    <td>${{ "{:,.2f}".format(comp.actual) }}</td>
                    <td>${{ "{:,.2f}".format(comp.target) }}</td>
                    <td class="{{ 'status-matched' if comp.status == 'MATCHED' else 'status-discrepancy' }}">
                        {{ comp.status }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if misc_logs %}
        <div class="misc-section">
            <h3 style="color: #4a5568;">Miscellaneous Bank Activity</h3>
            <table>
                <thead>
                    <tr style="background-color: #f8f9fa;">
                        <th>Date</th>
                        <th>Description</th>
                        <th style="text-align: right;">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in misc_logs %}
                    <tr>
                        <td>{{ item.date_cleared.strftime('%m/%d/%Y') }}</td>
                        <td>{{ item.description }}</td>
                        <td style="text-align: right; color: {{ '#ef4444' if item.amount < 0 else '#22c55e' }};">
                            ${{ "{:,.2f}".format(item.amount) }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <p>
            <a href="https://smartrenters-smart-fastapi.hf.space/?month_year={{ link_month }}" class="btn">
                Reconciliation Dashboard
            </a>
        </p>
    </div>
</body>
</html>